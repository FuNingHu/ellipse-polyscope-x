# Web UI Library System

This library was generated with [Nx](https://nx.dev).

This repo takes care of managing and documenting the entire UI library and design system
outputting the necessary npm packages that can be shared with third parties as well as the UI documentation site source code
that can be hosted as documentation.

## Prerequisites

### System Requirements

Please make sure you have NodeJs installed in your system.
Please visit the [NodeJs website](https://nodejs.org/en/) and install the **recommended version**.

## Getting Started

### Project Structure & WorkFlow

All the work happens in 2 places.

-   The `libs/ui-angular-components` folder should contain any code and style related to the components, as well as the tests
-   The `apps/ui-web-components` folder solely purposes is to transform the components built in `libs/ui-angular-components` into Web Components.
    All you do here is import any new component you create and define it as web component in `apps/ui-web-components/src/app.module.ts`.
-   The `libs/ui-angular-components/stories` folder where the components documentations, specs and examples files exist.
    Please refer the [Storybook Docs](https://storybook.js.org/docs/angular/writing-stories/introduction) for more details on how to create component stories.

The `libs/ui-angular-components` folder structure is a little different with the styles and components existing
in different folders. This is to make it easy to export all the sass files separated from the components
so third-parties can use them optionally.

All sass files handling for the npm packaging happens in the `libs/ui-angular-components/utils/copy-assets.js`.
When you are building and packing the library, `libs/ui-angular-components/utils/copy-assets.js` will take care of creating any CSS files
in addition of the SASS files as well as move any static assets. This is because Angular Library does not include
projects assets and style when building the library.

#### Updating the Component Readmes

All of the readmes in each component folder and subfolder in `/libs/ui-angular-components/src/lib/components` has a readme that has been autogenerated using compodoc and a custom parser. They are generated by running the command: 
```
nx run ui-angular-components:generate-markdown
```
or alternatively by running this NPM command: 
```
npm run ui-readme
```
**One of these commands must be run manually whenever the ui components are updated** as manual updates to the readme get overwritten when they are run.

See `/libs/ui-angular-components/utils/generate-ui-components-readme.js` for parsing code.


#### Updating the icon font

If you get a new vector from UX and need to create a new font:

-   Add the vector to the `libs/ui-angular-components/icons` directory
-   Run `nx run ui-angular-components:build`
    -   If this fails with _"Some SVGs files are NOT valid. SVGs must be 24x24."_ **ask UX to resize them to be 24x24 in size**. This keeps the sizes similar so that when you change the font size of the icons, they stay uniform.
    -   If you get any other failure about failing to read or write the SVGS, please ensure that the SVG code only contains paths and no polygons, nor complex shapes, nor layers. Groups and paths are the best option for creating SVGS that can be converted to a font. They must also be SOLID black so that they all appear the same when changing the font color and opacity.
-   Remember to manually version bumb `libs/ui-angular-components` & `apps/ui-web-components` (hopefully automated in future).

### Install

Before you run anything, execute the following command:

`npm install`

### IDE/ENV Configuration

For a much better coding experience and to avoid surprises when you push your code,
there are things you can configure in your environment that will help you a lot:

#### Config Lint Watchers

-   [WebStorm/Intellij Style Lint Config (Step 3 Only)](https://www.jetbrains.com/help/idea/using-stylelint-code-quality-tool.html)
-   [VSCode Style Lint Config](https://marketplace.visualstudio.com/items?itemName=stylelint.vscode-stylelint)
-   [WebStorm/Intellij Prettier Config](https://www.jetbrains.com/help/idea/prettier.html#ws_prettier_install)
-   [VSCode Prettier Config](https://marketplace.visualstudio.com/items?itemName=esbenp.prettier-vscode)

### Lint

It is important that you produce code that passes, both, CSS and Javascript linting checks.
This repo also check for code format using [Prettier](). Any problematic or confusing code format or rule should
be brought to the group and discussed openly.

For **_General_** lint check, run:

`nx lint ui-angular-components`

For **_CSS/SASS Style_** check, run:

`nx stylelint ui-angular-components`

For **_CSS/SASS Style FIX_**, run:

`nx stylelint-fix ui-angular-components`

**NOTE**: This will fix most of the style mistakes but not all. Some things require your attention. [Read More About This](https://stylelint.io/user-guide/usage/options#fix)

### Build

This repo will produce 3 artifacts for you.

-   UI Component npm package
-   UI Web Component npm package
-   Static Storybook/Documentation Web Page that you can host

To **_Build NPM Libraries_**, run:

`nx storybook ui-angular-components`

To **_Build UI Component Library ONLY_**, run:

`nx build-components ui-web-components`

To **_Build Static Documentation Page_**, run:

`nx build-storybook ui-angular-components`

**NOTE**: This will create a `storybook-static` folder at `.code/storybook/` where everything needed to show the docs will be present. Anytime you build or run storybook it will produce the`libs/ui-angular-components/documentation.json`which you manually build by running the command`nx docs-json ui-angular-components`.

### Run Locally

You will need to run the library locally for 2 reasons:

-   Visually check what you or anybody build along with the specs
-   Test the library npm package in your Frontend Application

#### Visualize as you code:

To see how all the components look, the entire doc with specs and examples, run:

`nx storybook ui-angular-components`

**NOTE**: This will let you see everything at [http://localhost:6006/](http://localhost:6006/).
Everytime you make a change it will automatically re-build so you can see the changes.

If you make changes to configuration (inside ./storybook) or feel like you are not getting your changes run the following
while storybook is running:

`nx docs-json ui-angular-components`

### Test

Any unit test should be put inside `/libs/ui-angular-components` and they are normal angular unit tests with jasmine.

To **_Test Only Angular Components_**, execute:

`nx test ui-angular-components`

To **_Test Web Components_**, execute once:

`nx test ui-web-components`

This will create a `/libs/ui-angular-components/public` folder with an `index.html` file which you will add your manual test to confirm that everything
you did and tested in the angular component also works as web component as well

### i18n
Translations can be found in 'assets/i18n' changes to the translation files requires a full rebuild of storybook.

{"ast":null,"code":"\"use strict\";\n\n// tslint:disable max-classes-per-file\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isWorkerRuntime = exports.getWorkerImplementation = exports.defaultPoolSize = void 0;\nconst get_bundle_url_browser_1 = require(\"./get-bundle-url.browser\");\nexports.defaultPoolSize = typeof navigator !== \"undefined\" && navigator.hardwareConcurrency ? navigator.hardwareConcurrency : 4;\nconst isAbsoluteURL = value => /^[a-zA-Z][a-zA-Z\\d+\\-.]*:/.test(value);\nfunction createSourceBlobURL(code) {\n  const blob = new Blob([code], {\n    type: \"application/javascript\"\n  });\n  return URL.createObjectURL(blob);\n}\nfunction selectWorkerImplementation() {\n  if (typeof Worker === \"undefined\") {\n    // Might happen on Safari, for instance\n    // The idea is to only fail if the constructor is actually used\n    return class NoWebWorker {\n      constructor() {\n        throw Error(\"No web worker implementation available. You might have tried to spawn a worker within a worker in a browser that doesn't support workers in workers.\");\n      }\n    };\n  }\n  class WebWorker extends Worker {\n    constructor(url, options) {\n      var _a, _b;\n      if (typeof url === \"string\" && options && options._baseURL) {\n        url = new URL(url, options._baseURL);\n      } else if (typeof url === \"string\" && !isAbsoluteURL(url) && get_bundle_url_browser_1.getBundleURL().match(/^file:\\/\\//i)) {\n        url = new URL(url, get_bundle_url_browser_1.getBundleURL().replace(/\\/[^\\/]+$/, \"/\"));\n        if ((_a = options === null || options === void 0 ? void 0 : options.CORSWorkaround) !== null && _a !== void 0 ? _a : true) {\n          url = createSourceBlobURL(`importScripts(${JSON.stringify(url)});`);\n        }\n      }\n      if (typeof url === \"string\" && isAbsoluteURL(url)) {\n        // Create source code blob loading JS file via `importScripts()`\n        // to circumvent worker CORS restrictions\n        if ((_b = options === null || options === void 0 ? void 0 : options.CORSWorkaround) !== null && _b !== void 0 ? _b : true) {\n          url = createSourceBlobURL(`importScripts(${JSON.stringify(url)});`);\n        }\n      }\n      super(url, options);\n    }\n  }\n  class BlobWorker extends WebWorker {\n    constructor(blob, options) {\n      const url = window.URL.createObjectURL(blob);\n      super(url, options);\n    }\n    static fromText(source, options) {\n      const blob = new window.Blob([source], {\n        type: \"text/javascript\"\n      });\n      return new BlobWorker(blob, options);\n    }\n  }\n  return {\n    blob: BlobWorker,\n    default: WebWorker\n  };\n}\nlet implementation;\nfunction getWorkerImplementation() {\n  if (!implementation) {\n    implementation = selectWorkerImplementation();\n  }\n  return implementation;\n}\nexports.getWorkerImplementation = getWorkerImplementation;\nfunction isWorkerRuntime() {\n  const isWindowContext = typeof self !== \"undefined\" && typeof Window !== \"undefined\" && self instanceof Window;\n  return typeof self !== \"undefined\" && self.postMessage && !isWindowContext ? true : false;\n}\nexports.isWorkerRuntime = isWorkerRuntime;","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}
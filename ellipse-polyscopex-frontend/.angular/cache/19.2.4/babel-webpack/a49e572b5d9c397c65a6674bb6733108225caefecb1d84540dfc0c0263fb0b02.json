{"ast":null,"code":";\nexport class ParallelHasher {\n  constructor(workerUri, workerOptions) {\n    this._queue = [];\n    this._ready = true;\n    const self = this;\n    if (Worker) {\n      self._hashWorker = new Worker(workerUri, workerOptions);\n      self._hashWorker.onmessage = self._recievedMessage.bind(self);\n      self._hashWorker.onerror = err => {\n        self._ready = false;\n        console.error('Hash worker failure', err);\n      };\n    } else {\n      self._ready = false;\n      console.error('Web Workers are not supported in this browser');\n    }\n  }\n  /**\n   * Hash a blob of data in the worker\n   * @param blob Data to hash\n   * @returns Promise of the Hashed result\n   */\n  hash(blob) {\n    const self = this;\n    let promise;\n    promise = new Promise((resolve, reject) => {\n      self._queue.push({\n        blob,\n        resolve,\n        reject\n      });\n      self._processNext();\n    });\n    return promise;\n  }\n  /** Terminate any existing hash requests */\n  terminate() {\n    this._ready = false;\n    this._hashWorker.terminate();\n  }\n  // Processes the next item in the queue\n  _processNext() {\n    if (this._ready && !this._processing && this._queue.length > 0) {\n      this._processing = this._queue.pop();\n      this._hashWorker.postMessage(this._processing.blob);\n    }\n  }\n  // Hash result is returned from the worker\n  _recievedMessage(evt) {\n    var _a, _b;\n    const data = evt.data;\n    if (data.success) {\n      (_a = this._processing) === null || _a === void 0 ? void 0 : _a.resolve(data.result);\n    } else {\n      (_b = this._processing) === null || _b === void 0 ? void 0 : _b.reject(data.result);\n    }\n    this._processing = undefined;\n    this._processNext();\n  }\n}\n//# sourceMappingURL=parallel_hasher.js.map","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}